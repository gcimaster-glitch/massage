<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOGUSY ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="max-w-4xl mx-auto p-8">
        <h1 class="text-3xl font-bold mb-8">ğŸ”§ HOGUSY å‹•ä½œç¢ºèªãƒšãƒ¼ã‚¸</h1>
        
        <!-- ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-bold mb-4">1. ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ</h2>
            <div class="space-y-3">
                <input type="email" id="email" value="keiri@inre.co.jp" 
                       class="w-full border p-2 rounded" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹">
                <input type="password" id="password" value="Hogusy2024!" 
                       class="w-full border p-2 rounded" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
                <button onclick="testLogin()" 
                        class="bg-teal-600 text-white px-4 py-2 rounded hover:bg-teal-700">
                    ãƒ­ã‚°ã‚¤ãƒ³
                </button>
                <div id="loginResult" class="mt-3"></div>
            </div>
        </div>
        
        <!-- ã‚»ãƒ©ãƒ”ã‚¹ãƒˆä¸€è¦§ -->
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-xl font-bold mb-4">2. ã‚»ãƒ©ãƒ”ã‚¹ãƒˆä¸€è¦§</h2>
            <button onclick="loadTherapists()" 
                    class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                ã‚»ãƒ©ãƒ”ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚€
            </button>
            <div id="therapistList" class="mt-4 space-y-3"></div>
        </div>
        
        <!-- äºˆç´„ãƒ†ã‚¹ãƒˆ -->
        <div class="bg-white p-6 rounded-lg shadow">
            <h2 class="text-xl font-bold mb-4">3. äºˆç´„ä½œæˆãƒ†ã‚¹ãƒˆ</h2>
            <p class="text-gray-600">ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ã‚»ãƒ©ãƒ”ã‚¹ãƒˆã‚’é¸æŠã—ã¦ãƒ†ã‚¹ãƒˆ</p>
            <div id="bookingTest"></div>
        </div>
    </div>

    <script>
        let authToken = localStorage.getItem('auth_token');
        
        // ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ
        async function testLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const result = document.getElementById('loginResult');
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authToken = data.token;
                    localStorage.setItem('auth_token', data.token);
                    result.innerHTML = `
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
                            âœ… ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸï¼<br>
                            ãƒ¦ãƒ¼ã‚¶ãƒ¼: ${data.user.name}<br>
                            ãƒ­ãƒ¼ãƒ«: ${data.user.role}
                        </div>
                    `;
                } else {
                    result.innerHTML = `
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                            âŒ ${data.error}
                        </div>
                    `;
                }
            } catch (error) {
                result.innerHTML = `
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                        âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}
                    </div>
                `;
            }
        }
        
        // ã‚»ãƒ©ãƒ”ã‚¹ãƒˆä¸€è¦§
        async function loadTherapists() {
            const list = document.getElementById('therapistList');
            list.innerHTML = '<p class="text-gray-500">èª­ã¿è¾¼ã¿ä¸­...</p>';
            
            try {
                const response = await fetch('/api/therapists?limit=5');
                const data = await response.json();
                
                if (data.therapists && data.therapists.length > 0) {
                    list.innerHTML = `
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-3">
                            âœ… ${data.total}åã®ã‚»ãƒ©ãƒ”ã‚¹ãƒˆã‚’å–å¾—
                        </div>
                        ${data.therapists.map(t => `
                            <div class="border p-3 rounded">
                                <p class="font-bold">${t.name}</p>
                                <p class="text-sm text-gray-600">â­ ${t.rating} (${t.review_count}ä»¶)</p>
                                <p class="text-sm">${t.bio}</p>
                                <a href="/therapists/${t.id}" class="text-blue-600 text-sm">è©³ç´°ã‚’è¦‹ã‚‹ â†’</a>
                            </div>
                        `).join('')}
                    `;
                } else {
                    list.innerHTML = `
                        <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded">
                            âš ï¸ ã‚»ãƒ©ãƒ”ã‚¹ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
                        </div>
                    `;
                }
            } catch (error) {
                list.innerHTML = `
                    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                        âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}
                    </div>
                `;
            }
        }
        
        // èµ·å‹•æ™‚ã«ãƒˆãƒ¼ã‚¯ãƒ³ãƒã‚§ãƒƒã‚¯
        if (authToken) {
            document.getElementById('loginResult').innerHTML = `
                <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded">
                    â„¹ï¸ ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã‚ã‚Šï¼‰
                </div>
            `;
        }
    </script>
</body>
</html>
